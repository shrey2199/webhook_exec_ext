<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Webhook Executor - Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Webhook Executor</h1>
      <p class="subtitle">Configure your webhooks with dynamic variables</p>
    </header>

    <div class="main-content">
      <!-- Webhooks List Section -->
      <section class="webhooks-section">
        <div class="section-header">
          <h2>Your Webhooks</h2>
          <div class="header-actions">
            <div class="dropdown">
              <button id="backupBtn" class="btn btn-secondary dropdown-btn">üíæ Backup ‚ñº</button>
              <div id="backupDropdown" class="dropdown-content">
                <button id="copyJsonBtn" class="dropdown-item">üìã Copy JSON</button>
                <button id="downloadBackupBtn" class="dropdown-item">üíæ Download File</button>
              </div>
            </div>
            <div class="dropdown">
              <button id="restoreBtn" class="btn btn-secondary dropdown-btn">üì• Restore ‚ñº</button>
              <div id="restoreDropdown" class="dropdown-content">
                <button id="pasteJsonBtn" class="dropdown-item">üìÑ Paste JSON</button>
                <button id="uploadBackupBtn" class="dropdown-item">üìÅ Upload File</button>
              </div>
              <input type="file" id="backupFileInput" accept=".json" style="display: none;">
            </div>
            <button id="addWebhookBtn" class="btn btn-primary">+ Add Webhook</button>
          </div>
        </div>
        
        <div id="webhooksList" class="webhooks-list">
          <!-- Webhook items will be dynamically added here -->
        </div>
      </section>
    </div>
    
    <footer class="page-footer">
      <div class="about-section">
        <h3>About</h3>
        <p>Webhook Executor - Browser Extension</p>
        <p class="version">Version 1.1.0</p>
        <p class="creator">Made with ‚ù§Ô∏è by <strong>Shreyansh</strong></p>
        <p class="links">
          <a href="https://github.com/shrey2199/webhook_exec_ext" target="_blank" rel="noopener">GitHub</a>
        </p>
      </div>
    </footer>
  </div>

  <!-- Webhook Modal -->
  <div id="webhookModal" class="modal">
    <div class="modal-content" id="mainModalContent">
      <div class="modal-header">
        <h2 id="modalTitle">Add Webhook</h2>
        <div class="header-buttons">
          <button type="button" class="btn btn-outline" id="toggleVariablesBtn">
            <span id="toggleVariablesText">üìÑ Show Variables</span>
          </button>
          <button class="close-btn" id="closeModal">&times;</button>
        </div>
      </div>
      
      <form id="webhookForm">
        <input type="hidden" id="webhookId">
        
        <div class="form-group">
          <label for="webhookName">Webhook Name *</label>
          <input type="text" id="webhookName" placeholder="My Webhook" required>
        </div>

        <div class="form-group">
          <label for="webhookUrl">URL *</label>
          <input type="url" id="webhookUrl" placeholder="https://api.example.com/webhook" required>
          <small>Tip: You can use variables like https://api.example.com/log?site={page_domain}</small>
        </div>

        <div class="form-group">
          <label for="webhookMethod">HTTP Method</label>
          <select id="webhookMethod">
            <option value="POST">POST</option>
            <option value="GET">GET</option>
            <option value="PUT">PUT</option>
            <option value="PATCH">PATCH</option>
            <option value="DELETE">DELETE</option>
          </select>
        </div>

        <div class="form-group">
          <label>Headers</label>
          <div id="headersList" class="key-value-list"></div>
          <button type="button" class="btn btn-small" id="addHeaderBtn">+ Add Header</button>
        </div>

        <div class="form-group">
          <label>URL Parameters</label>
          <div id="paramsList" class="key-value-list"></div>
          <button type="button" class="btn btn-small" id="addParamBtn">+ Add Parameter</button>
          <small>Example: Key: "site", Value: "{page_domain}"</small>
        </div>

        <div class="form-group">
          <label for="webhookPayload">Payload (for POST/PUT/PATCH)</label>
          <textarea id="webhookPayload" rows="6" placeholder='{"site": "{page_domain}", "url": "{page_url}", "title": "{page_title}"}'></textarea>
          <small>Use JSON format with variables</small>
        </div>

        <div class="form-group">
          <label for="loadingText">Loading Text</label>
          <input type="text" id="loadingText" placeholder="Executing webhook..." value="Executing webhook...">
          <small>Text shown while webhook is executing</small>
        </div>

        <div class="form-group checkbox-group">
          <label>
            <input type="checkbox" id="enableResponseCheck">
            <span>Enable Response Check</span>
          </label>
        </div>

        <div id="responseCheckOptions" class="response-check-section" style="display: none;">
          <div class="form-group">
            <label for="responseType">Response Type</label>
            <select id="responseType">
              <option value="status_code">HTTP Status Code</option>
              <option value="text_contains">Response Contains Text</option>
              <option value="json_path">JSON Path Value</option>
            </select>
            <small>How to check if the webhook was successful</small>
          </div>

          <div class="form-group">
            <label for="responseValue">Expected Value</label>
            <input type="text" id="responseValue" placeholder="200">
            <small id="responseValueHint">e.g., 200 for status code, "success" for text, or path like "status"</small>
          </div>
        </div>

        <div class="form-group checkbox-group">
          <label>
            <input type="checkbox" id="showInContextMenu">
            <span>Show in right-click context menu</span>
          </label>
        </div>

        <div class="form-group">
          <label>URL Preview</label>
          <div id="urlPreview" class="url-preview">
            <code>Configure URL and params to see preview</code>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
          <button type="submit" class="btn btn-primary">Save Webhook</button>
        </div>
      </form>
    </div>
    
    <!-- Variables Modal - Slides in from right -->
    <div class="variables-modal" id="variablesModal">
      <div class="variables-modal-header">
        <h3>Available Variables</h3>
        <p class="info-text">Click to copy</p>
      </div>
      <div class="variables-modal-content">
        <div class="variables-list">
          <div class="variable-item" data-var="{page_url}">
            <code class="var-tag">{page_url}</code>
            <span class="variable-desc">Full page URL (or clicked link URL)</span>
          </div>
          <div class="variable-item" data-var="{page_title}">
            <code class="var-tag">{page_title}</code>
            <span class="variable-desc">Page title</span>
          </div>
          <div class="variable-item" data-var="{page_domain}">
            <code class="var-tag">{page_domain}</code>
            <span class="variable-desc">Page domain</span>
          </div>
          <div class="variable-item" data-var="{page_protocol}">
            <code class="var-tag">{page_protocol}</code>
            <span class="variable-desc">Protocol (http/https)</span>
          </div>
          <div class="variable-item" data-var="{selected_text}">
            <code class="var-tag">{selected_text}</code>
            <span class="variable-desc">Currently selected text</span>
          </div>
          <div class="variable-item" data-var="{timestamp}">
            <code class="var-tag">{timestamp}</code>
            <span class="variable-desc">Unix timestamp (ms)</span>
          </div>
          <div class="variable-item" data-var="{date}">
            <code class="var-tag">{date}</code>
            <span class="variable-desc">Current date (YYYY-MM-DD)</span>
          </div>
          <div class="variable-item" data-var="{time}">
            <code class="var-tag">{time}</code>
            <span class="variable-desc">Current time (HH:MM:SS)</span>
          </div>
          <div class="variable-item" data-var="{datetime}">
            <code class="var-tag">{datetime}</code>
            <span class="variable-desc">ISO 8601 datetime</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="options.js"></script>
</body>
</html>
